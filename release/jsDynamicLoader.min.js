/**
 * jsDynamicLoad Component
 * 
 * @author	gunnymong@gmail.com
 * @version	1.0
 * @since	2012.01
 */
jsDynamicLoad={_htLoadFile:{},_aLoadFileQueue:[],_elHead:document.getElementsByTagName("head")[0],_bIe:(navigator.userAgent.toLowerCase().indexOf("msie")!=-1)?true:false,include:function(sSrc,fCallback,sCharset){var sScripturl=sSrc||null;var fCallback=fCallback||null;var sCharset=sCharset||"UTF-8";if(sScripturl==null){return}if(this._htLoadFile[sScripturl]==null){this._htLoadFile[sScripturl]=fCallback;var nQueueCount=this._aLoadFileQueue.length;this._aLoadFileQueue[nQueueCount]={src:sScripturl,charset:sCharset,response:null,done:false};var self=this;var oXhr=this._loadXHR();oXhr.onreadystatechange=function(){if(oXhr.readyState==4&&oXhr.status==200){self._aLoadFileQueue[nQueueCount].response=oXhr.responseText;self._createScriptTag()}};oXhr.open("GET",sScripturl);oXhr.send("")}},_createScriptTag:function(){var oLoadFileQue=null;for(var i=0,cnt=this._aLoadFileQueue.length;i<cnt;i++){oLoadFileQue=this._aLoadFileQueue[i];if(!oLoadFileQue.done){if(oLoadFileQue.response){var oScript=document.createElement("script");oScript.type="text/javascript";oScript.charset=oLoadFileQue.charset;oScript.text=oLoadFileQue.response;oLoadFileQue.done=true;this._elHead.appendChild(oScript);this._callBack(oScript,oLoadFileQue.src)}else{break}}}},_callBack:function(oScript,sSrc){var fCallback=this._htLoadFile[sSrc]||null;if(!this._bIe){this._elHead.removeChild(oScript)}if(fCallback){if(oScript.reasyState){oScript.onreadystatechange=function(){if(oScript.readyState==="loaded"||oScript.readyState==="complete"){oScript.onload=fCallback();oScript.onreadystatechange=null}}}else{oScript.onload=fCallback()}}oScript=null;return},_loadXHR:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(ActiveXObject){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}return null}}}};